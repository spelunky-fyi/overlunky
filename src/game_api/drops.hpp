#pragma once

#include "virtual_table.hpp"
#include <cstdint>
#include <string>
#include <vector>
using namespace std::string_literals;

struct DropEntry
{
    std::string caption;
    std::string pattern;
    VTABLE_OFFSET vtable_offset; // some patterns are not found in the vtables, use NONE to look for pattern in entire exe
    uint32_t vtable_rel_offset;
    uint8_t value_offset = 0;      // the offset of the value to be replaced within the pattern
    uint8_t vtable_occurrence = 1; // when a value occurs more than once in the same virtual table function, choose how many times to replace
    size_t offsets[3] = {0};
};

struct DropChanceEntry
{
    std::string caption;
    std::string pattern;
    VTABLE_OFFSET vtable_offset;
    uint32_t vtable_rel_offset;
    uint8_t chance_sizeof = 4;
    size_t offset = 0;
};

static std::vector<DropEntry> drop_entries = {
    {"ALTAR_DICE_CLIMBINGGLOVES", "\x0B\x02\x00\x00"s, VTABLE_OFFSET::FLOOR_ALTAR, 25},
    {"ALTAR_DICE_COOKEDTURKEY", "\x04\x02\x00\x00"s, VTABLE_OFFSET::FLOOR_ALTAR, 25},
    {"ALTAR_DICE_DIAMOND", "\xBB\xF1\x01\x00\x00"s, VTABLE_OFFSET::FLOOR_ALTAR, 25, 1},
    {"ALTAR_DICE_MACHETE", "\x46\x02\x00\x00"s, VTABLE_OFFSET::FLOOR_ALTAR, 25},
    {"ALTAR_DICE_ROPEPILE", "\xBB\x00\x02\x00\x00"s, VTABLE_OFFSET::FLOOR_ALTAR, 25, 1},
    {"ALTAR_DICE_SPECTACLES", "\x83\xBB\x0A\x02\x00\x00"s, VTABLE_OFFSET::FLOOR_ALTAR, 25, 2},
    {"ALTAR_DICE_TELEPACK", "\x38\x02\x00\x00"s, VTABLE_OFFSET::FLOOR_ALTAR, 25},
    {"ALTAR_DICE_VAMPIRE", "\xBB\xF5\x00\x00\x00"s, VTABLE_OFFSET::FLOOR_ALTAR, 25, 1},
    {"ALTAR_DICE_WEBGUN", "\x3E\x02\x00\x00"s, VTABLE_OFFSET::FLOOR_ALTAR, 25},
    {"ALTAR_IDOL_GOLDEN_MONKEY", "\x35\x01\x00\x00"s, VTABLE_OFFSET::FLOOR_ALTAR, 25},
    {"ALTAR_KAPALA", "\x14\x02\x00\x00"s, VTABLE_OFFSET::FLOOR_ALTAR, 25, 0, 2},
    {"ALTAR_PRESENT_EGGPLANT", "\xE7\x01\x00\x00"s, VTABLE_OFFSET::FLOOR_ALTAR, 25},
    {"ALTAR_ROCK_WOODENARROW", "\x73\x01\x00\x00"s, VTABLE_OFFSET::FLOOR_ALTAR, 25},
    {"ALTAR_ROYAL_JELLY", "\x03\x02\x00\x00"s, VTABLE_OFFSET::FLOOR_ALTAR, 25},
    {"ALTAR_USHABTI_CAVEMAN", "\xE1\x00\x00\x00"s, VTABLE_OFFSET::FLOOR_ALTAR, 25},
    {"ALTAR_USHABTI_TURKEY", "\x81\x03\x00\x00"s, VTABLE_OFFSET::FLOOR_ALTAR, 25},
    {"ALTAR_USHABTI_VAMPIRE", "\xBA\xF5\x00\x00\x00"s, VTABLE_OFFSET::FLOOR_ALTAR, 25, 1},
    {"ANUBIS2_JETPACK", "\x35\x02\x00\x00"s, VTABLE_OFFSET::MONS_ANUBIS2, 2},
    {"ANUBIS_SCEPTER", "\x4A\x02\x00\x00"s, VTABLE_OFFSET::MONS_ANUBIS, 2},
    {"BEG_BOMBBAG", "\x0F\x28\xD0\xBA\x01\x02\x00\x00"s, VTABLE_OFFSET::NONE, 0, 4},
    {"BEG_TRUECROWN", "\x18\x02\x00\x00"s, VTABLE_OFFSET::MONS_HUNDUNS_SERVANT, 103},
    {"BONEPILE_SKELETONKEY", "\x1B\x02\x00\x00"s, VTABLE_OFFSET::ACTIVEFLOOR_BONEBLOCK, 2},
    {"BONEPILE_SKULL", "\xE2\x01\x00\x00"s, VTABLE_OFFSET::ACTIVEFLOOR_BONEBLOCK, 2},
    {"CROCMAN_TELEPACK", "\x38\x02\x00\x00"s, VTABLE_OFFSET::MONS_CROCMAN, 2},
    {"CROCMAN_TELEPORTER", "\x43\x02\x00\x00"s, VTABLE_OFFSET::MONS_CROCMAN, 2},
    {"GHOSTJAR_DIAMOND", "\xF1\x01\x00\x00"s, VTABLE_OFFSET::ITEM_CURSEDPOT, 2},
    {"GHOST_DIAMOND", "\xF1\x01\x00\x00"s, VTABLE_OFFSET::MONS_GHOST, 25},
    {"GIANTSPIDER_PASTE", "\x0F\x02\x00\x00"s, VTABLE_OFFSET::MONS_GIANTSPIDER, 2},
    {"GOLDENMONKEY_NUGGET", "\xF5\x01\x00\x00"s, VTABLE_OFFSET::MONS_GOLDMONKEY, 77},
    {"GOLDENMONKEY_SMALLEMERALD", "\xF7\x01\x00\x00"s, VTABLE_OFFSET::MONS_GOLDMONKEY, 77},
    {"GOLDENMONKEY_SMALLNUGGET", "\xFA\x01\x00\x00"s, VTABLE_OFFSET::MONS_GOLDMONKEY, 77},
    {"GOLDENMONKEY_SMALLRUBY", "\xF9\x01\x00\x00"s, VTABLE_OFFSET::MONS_GOLDMONKEY, 77},
    {"GOLDENMONKEY_SMALLSAPPHIRE", "\xF8\x01\x00\x00"s, VTABLE_OFFSET::MONS_GOLDMONKEY, 77},
    {"GOLDENPARACHUTE_SMALLNUGGET", "\x65\x48\x8B\x04\x25\x58\x00\x00\x00\xBD\xFA\x01\x00\x00"s, VTABLE_OFFSET::NONE, 0, 10},
    {"HANGINGSPIDER_WEBGUN", "\x3E\x02\x00\x00"s, VTABLE_OFFSET::MONS_HANGSPIDER, 2},
    {"ICECAVE_BOULDER", "\x55\x02\x00\x00"s, VTABLE_OFFSET::LOGICAL_BOULDERSPAWNER, 36},
    {"JIANGSHIASSASSIN_SPIKESHOES", "\x0E\x02\x00\x00"s, VTABLE_OFFSET::MONS_FEMALE_JIANGSHI, 2},
    {"JIANGSHI_SPRINGSHOES", "\x0D\x02\x00\x00"s, VTABLE_OFFSET::MONS_JIANGSHI, 2},
    {"KINGU_TABLETOFDESTINY", "\x1A\x02\x00\x00"s, VTABLE_OFFSET::MONS_KINGU, 2},
    {"LEPRECHAUN_CLOVER", "\x07\x02\x00\x00"s, VTABLE_OFFSET::MONS_LEPRECHAUN, 2},
    {"MATTOCK_BROKENMATTOCK", "\xAC\x01\x00\x00"s, VTABLE_OFFSET::ITEM_MATTOCK, 76},
    {"MOLE_MATTOCK", "\x44\x02\x00\x00"s, VTABLE_OFFSET::MONS_MOLE, 2},
    {"MOSQUITO_HOVERPACK", "\x3A\x02\x00\x00"s, VTABLE_OFFSET::MONS_MOSQUITO, 2},
    {"MUMMY_DIAMOND", "\xF1\x01\x00\x00"s, VTABLE_OFFSET::MONS_MUMMY, 2},
    {"MUMMY_FLY", "\xB4\x01\x00\x00"s, VTABLE_OFFSET::LOGICAL_MUMMYFLIES_SOUND_SOURCE, 36},
    {"NECROMANCER_RUBY", "\xF4\x01\x00\x00"s, VTABLE_OFFSET::MONS_NECROMANCER, 2},
    {"OLMEC_BOMB", "\x5B\x01\x00\x00"s, VTABLE_OFFSET::ITEM_OLMECCANNON_BOMBS, 92},
    {"OLMEC_CAVEMEN", "\x0F\x28\xDF\xBA\xE1\x00\x00\x00"s, VTABLE_OFFSET::NONE, 0, 4},
    {"OLMEC_UFO", "\x0A\x01\x00\x00"s, VTABLE_OFFSET::ITEM_OLMECCANNON_UFO, 92},
    {"OSIRIS_EMERALDS", "\x44\x88\x64\x24\x20\xBA\xF2\x01\x00\x00"s, VTABLE_OFFSET::NONE, 0, 6},
    {"OSIRIS_TABLETOFDESTINY", "\x0F\x28\xD0\xBA\x1A\x02\x00\x00\x49"s, VTABLE_OFFSET::NONE, 0, 4},
    {"PANGXIE_ACIDBUBBLE", "\x88\x01\x00\x00"s, VTABLE_OFFSET::MONS_CRABMAN, 77},
    {"QUEENBEE_ROYALJELLY", "\x03\x02\x00\x00"s, VTABLE_OFFSET::MONS_QUEENBEE, 2},
    {"ROBOT_METALSHIELD", "\x4E\x02\x00\x00"s, VTABLE_OFFSET::MONS_ROBOT, 2},
    {"SCEPTER_ANUBISSPECIALSHOT", "\x79\x01\x00\x00"s, VTABLE_OFFSET::MONS_ANUBIS, 101}, // anubis regular shot = new_drop_uid - 1 !
    {"SCEPTER_PLAYERSHOT", "\x7A\x01\x00\x00"s, VTABLE_OFFSET::ITEM_SCEPTER, 23},
    {"SHOPKEEPER_GOLDCOIN", "\xF6\x01\x00\x00"s, VTABLE_OFFSET::MONS_MERCHANT, 108},
    {"SKELETON_SKELETONKEY", "\x1B\x02\x00\x00"s, VTABLE_OFFSET::MONS_SKELETON, 2},
    {"SORCERESS_RUBY", "\xF4\x01\x00\x00"s, VTABLE_OFFSET::MONS_SORCERESS, 2},
    {"SPARROW_ROPEPILE", "\x00\x02\x00\x00"s, VTABLE_OFFSET::MONS_THIEF, 103},
    {"SPARROW_SKELETONKEY", "\x1B\x02\x00\x00"s, VTABLE_OFFSET::MONS_THIEF, 2},
    {"TIAMAT_BAT", "\xE0\x00\x00\x00"s, VTABLE_OFFSET::ITEM_TIAMAT_SHOT, 77},
    {"TIAMAT_BEE", "\x58\xD0\xBA\x16\x01\x00\x00"s, VTABLE_OFFSET::ITEM_TIAMAT_SHOT, 77, 3},
    {"TIAMAT_CAVEMAN", "\x58\xD0\xBA\xE1\x00\x00\x00"s, VTABLE_OFFSET::ITEM_TIAMAT_SHOT, 77, 3},
    {"TIAMAT_COBRA", "\x58\xD0\xBA\xF8\x00\x00\x00"s, VTABLE_OFFSET::ITEM_TIAMAT_SHOT, 77, 3},
    {"TIAMAT_HERMITCRAB", "\x08\x01\x00\x00"s, VTABLE_OFFSET::ITEM_TIAMAT_SHOT, 77},
    {"TIAMAT_MONKEY", "\x58\xD0\xBA\xEE\x00\x00\x00"s, VTABLE_OFFSET::ITEM_TIAMAT_SHOT, 77, 3},
    {"TIAMAT_MOSQUITO", "\x58\xD0\xBA\xED\x00\x00\x00"s, VTABLE_OFFSET::ITEM_TIAMAT_SHOT, 77, 3},
    {"TIAMAT_OCTOPUS", "\x58\xD0\xBA\x07\x01\x00\x00"s, VTABLE_OFFSET::ITEM_TIAMAT_SHOT, 77, 3},
    {"TIAMAT_OLMITE", "\x58\xD0\xBA\x15\x01\x00\x00"s, VTABLE_OFFSET::ITEM_TIAMAT_SHOT, 77, 3},
    {"TIAMAT_SCORPION", "\x58\xD0\xBA\xE5\x00\x00\x00"s, VTABLE_OFFSET::ITEM_TIAMAT_SHOT, 77, 3},
    {"TIAMAT_SHOT", "\x80\x01\x00\x00"s, VTABLE_OFFSET::MONS_TIAMAT, 77},
    {"TIAMAT_SNAKE", "\x58\xD0\xBA\xDC\x00\x00\x00"s, VTABLE_OFFSET::ITEM_TIAMAT_SHOT, 77, 3},
    {"TIAMAT_UFO", "\x58\xD0\xBA\x0A\x01\x00\x00"s, VTABLE_OFFSET::ITEM_TIAMAT_SHOT, 77, 3},
    {"TIAMAT_YETI", "\x58\xD0\xBA\x0C\x01\x00\x00"s, VTABLE_OFFSET::ITEM_TIAMAT_SHOT, 77, 3},
    {"TORCH_SMALLNUGGET", "\xFA\x01\x00\x00"s, VTABLE_OFFSET::ITEM_LIT_WALLTORCH, 92},
    {"TURKEY_COOKEDTURKEY", "\x04\x02\x00\x00"s, VTABLE_OFFSET::MOUNT_TURKEY, 49},
    {"UFO_PARACHUTE", "\x12\x02\x00\x00"s, VTABLE_OFFSET::MONS_UFO, 77},
    {"VAMPIRE_CAPE", "\x32\x02\x00\x00"s, VTABLE_OFFSET::MONS_VAMPIRE, 2},
    {"VAN_HORSING_COMPASS", "\x11\x02\x00\x00"s, VTABLE_OFFSET::MONS_OLD_HUNTER, 103},
    {"VAN_HORSING_DIAMOND", "\xF1\x01\x00\x00"s, VTABLE_OFFSET::MONS_OLD_HUNTER, 103},
    {"VLAD_VLADSCAPE", "\x33\x02\x00\x00"s, VTABLE_OFFSET::MONS_VAMPIRE, 2},
    {"YETIKING_FREEZERAY", "\x40\x02\x00\x00"s, VTABLE_OFFSET::MONS_YETIKING, 104},
    {"YETIKING_ICESPIRE", "\xE8\x01\x00\x00"s, VTABLE_OFFSET::MONS_YETIKING, 103},
    {"YETIQUEEN_POWERPACK", "\x3C\x02\x00\x00"s, VTABLE_OFFSET::MONS_YETIQUEEN, 104},
    {"YETI_PITCHERSMITT", "\x0C\x02\x00\x00"s, VTABLE_OFFSET::MONS_YETI, 2},
};

static std::vector<DropChanceEntry> dropchance_entries = {
    {"BONEBLOCK_SKELETONKEY", "\xE8\x03\x00\x00"s, VTABLE_OFFSET::ACTIVEFLOOR_BONEBLOCK, 2},
    {"CROCMAN_TELEPACK", "\x64"s, VTABLE_OFFSET::MONS_CROCMAN, 2, 1},
    {"HANGINGSPIDER_WEBGUN", "\xE8\x03\x00\x00"s, VTABLE_OFFSET::MONS_HANGSPIDER, 2},
    {"JIANGSHIASSASSIN_SPIKESHOES", "\xE8\x03\x00\x00"s, VTABLE_OFFSET::MONS_FEMALE_JIANGSHI, 2},
    {"JIANGSHI_SPRINGSHOES", "\xE8\x03\x00\x00"s, VTABLE_OFFSET::MONS_JIANGSHI, 2},
    {"MOLE_MATTOCK", "\xE8\x03\x00\x00"s, VTABLE_OFFSET::MONS_MOLE, 2},
    {"MOSQUITO_HOVERPACK", "\xE8\x03\x00\x00"s, VTABLE_OFFSET::MONS_MOSQUITO, 2},
    {"ROBOT_METALSHIELD", "\x64"s, VTABLE_OFFSET::MONS_ROBOT, 2, 1},
    {"SKELETON_SKELETONKEY", "\xE8\x03\x00\x00"s, VTABLE_OFFSET::MONS_SKELETON, 2},
    {"UFO_PARACHUTE", "\xE8\x03\x00\x00"s, VTABLE_OFFSET::MONS_UFO, 77},
    {"YETI_PITCHERSMITT", "\xE8\x03\x00\x00"s, VTABLE_OFFSET::MONS_YETI, 2},
};
